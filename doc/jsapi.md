Sparkling JavaScript API
========================

General
-------
The Sparkling JS API consists of the JSpn object and its methods.
You can use the Sparkling API in your JavaScript program by
including the `libspn.js` script file. You can also try the JS
API by opening the `libspn.html` file. This is autogenerated by
the Emscripten compiler. Open a JavaScript console here and type
in the sample code (see later below). Profit.


The workflow in JavaScript is similar to the usage of the C API:
 - first you compile a Sparkling source string into a function.
   This is accomplished using `JSpn.compile()`, which returns
   a JavaScript function that wraps the corresponding Sparkling
   program if succeeds. On error, it returns `null`. Should an
   error occur, an error message is available via `JSpn.error()`.
 - Then you call the function with some parameters (if any).
 - If an error occurs, the function returns null, and you can
   get the error message using the `JSpn.error()` function.


Mapping between Sparkling and JavaScript types:

	nil		->	  undefined
	bool		->	  boolean
	number		->	  number
	string		->	  string
	array		->	  currently unavailable
	function	->	  currently unavailable
	userinfo	->	  currently unavailable

Caveats
-------

This is just experimental. Some things don't work, e. g. it's not
currently possible to pass arrays and other functions to a
Sparkling function or to return an array or a function from
a Sparkling function. (This is because of some limitations in
Emscripten and the inherently different nature of JavaScript and
C; I am working on this, so expect some sort of terribly ugly
hack to make all this possible sooner or later.)
Userinfo objects don't work. Since on the web, they don't
make sense anyway (they can only be generated by native extension
functions, which aren't normally available in a browser), I don't
think they will be added soon, but maybe if someone needs them,
I'll look into that as well.

Naturally, these restrictions only concern the communication
between Sparkling and JavaScript. Sparkling code can still use
all types without restriction, Sparkling functions can call each
other with arguments of any type, etc.

Example:
--------
Type this into a JavaScript console on `libspn.html`, or open a JSC
session and import `libspn.js`, etc.

    > var fn = JSpn.compile("return \"Hello, \" .. #0 .. \"!\";");
    undefined
    > var greetMe = fn("H2CO3");
    undefined
    > greetMe
    "Hello, H2CO3!"

